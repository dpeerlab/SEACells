nohup: ignoring input
findfont: Font family ['Raleway'] not found. Falling back to DejaVu Sans.
findfont: Font family ['Lato'] not found. Falling back to DejaVu Sans.
SPARSE AND GPU
TRYING SEACellsGPU
Welcome to SEACells GPU!
build_graph.SEACellGraph completed
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s]/home/aparna/miniconda3/lib/python3.9/site-packages/cupyx/scipy/sparse/_compressed.py:545: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive.
  warnings.warn('Changing the sparsity structure of a '
 17%|█▋        | 4/24 [00:00<00:00, 32.67it/s] 38%|███▊      | 9/24 [00:00<00:00, 39.19it/s] 58%|█████▊    | 14/24 [00:00<00:00, 39.18it/s] 75%|███████▌  | 18/24 [00:00<00:00, 38.90it/s] 92%|█████████▏| 22/24 [00:00<00:00, 35.45it/s]100%|██████████| 24/24 [00:00<00:00, 35.81it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Convergence threshold set to 0.0017809197686690815 based on epsilon = 1e-05
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Starting iteration 40.
Completed iteration 40.
Converged after 45 iterations.
NOT SPARSE AND GPU
TRYING SEACellsGPUDense
Welcome to SEACells GPU!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 42%|████▏     | 10/24 [00:00<00:00, 96.45it/s] 96%|█████████▌| 23/24 [00:00<00:00, 113.28it/s]100%|██████████| 24/24 [00:00<00:00, 110.97it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Converged after 36 iterations.
SPARSE AND NOT GPU
TRYING SEACellsCPU
Welcome to SEACells!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 42%|████▏     | 10/24 [00:00<00:00, 92.28it/s] 92%|█████████▏| 22/24 [00:00<00:00, 103.90it/s]100%|██████████| 24/24 [00:00<00:00, 103.16it/s]
nohup: ignoring input
findfont: Font family ['Raleway'] not found. Falling back to DejaVu Sans.
findfont: Font family ['Lato'] not found. Falling back to DejaVu Sans.
SPARSE AND GPU
TRYING SEACellsGPU
Welcome to SEACells GPU!
build_graph.SEACellGraph completed
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/50000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/50000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/50000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 643 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/33 [00:00<?, ?it/s]/home/aparna/miniconda3/lib/python3.9/site-packages/cupyx/scipy/sparse/_compressed.py:545: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive.
  warnings.warn('Changing the sparsity structure of a '
  9%|▉         | 3/33 [00:00<00:01, 22.85it/s] 18%|█▊        | 6/33 [00:00<00:01, 22.80it/s] 27%|██▋       | 9/33 [00:00<00:01, 20.99it/s] 36%|███▋      | 12/33 [00:00<00:01, 20.07it/s] 45%|████▌     | 15/33 [00:00<00:00, 19.21it/s] 52%|█████▏    | 17/33 [00:00<00:00, 18.46it/s] 58%|█████▊    | 19/33 [00:00<00:00, 17.88it/s] 64%|██████▎   | 21/33 [00:01<00:00, 16.73it/s] 70%|██████▉   | 23/33 [00:01<00:00, 15.81it/s] 76%|███████▌  | 25/33 [00:01<00:00, 15.04it/s] 82%|████████▏ | 27/33 [00:01<00:00, 14.10it/s] 88%|████████▊ | 29/33 [00:01<00:00, 13.49it/s] 94%|█████████▍| 31/33 [00:01<00:00, 13.00it/s]100%|██████████| 33/33 [00:02<00:00, 12.54it/s]100%|██████████| 33/33 [00:02<00:00, 15.79it/s]
Traceback (most recent call last):
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1544, in cupy_backends.cuda.libs.cusparse.check_status
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1534, in cupy_backends.cuda.libs.cusparse.CuSparseError.__init__
KeyError: 11
Exception ignored in: 'cupy_backends.cuda.libs.cusparse.spGEMM_workEstimation'
Traceback (most recent call last):
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1544, in cupy_backends.cuda.libs.cusparse.check_status
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1534, in cupy_backends.cuda.libs.cusparse.CuSparseError.__init__
KeyError: 11
Traceback (most recent call last):
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1544, in cupy_backends.cuda.libs.cusparse.check_status
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1534, in cupy_backends.cuda.libs.cusparse.CuSparseError.__init__
KeyError: 11
Exception ignored in: 'cupy_backends.cuda.libs.cusparse.spGEMM_workEstimation'
Traceback (most recent call last):
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1544, in cupy_backends.cuda.libs.cusparse.check_status
  File "cupy_backends/cuda/libs/cusparse.pyx", line 1534, in cupy_backends.cuda.libs.cusparse.CuSparseError.__init__
KeyError: 11
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Starting iteration 40.
Completed iteration 40.
Converged after 41 iterations.
Done with 10000 cells, trial 1
SPARSE AND GPU
TRYING SEACellsGPU
Welcome to SEACells GPU!
build_graph.SEACellGraph completed
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s]/home/aparna/miniconda3/lib/python3.9/site-packages/cupyx/scipy/sparse/_compressed.py:545: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive.
  warnings.warn('Changing the sparsity structure of a '
 21%|██        | 5/24 [00:00<00:00, 42.78it/s] 42%|████▏     | 10/24 [00:00<00:00, 43.86it/s] 62%|██████▎   | 15/24 [00:00<00:00, 40.09it/s] 83%|████████▎ | 20/24 [00:00<00:00, 37.57it/s]100%|██████████| 24/24 [00:00<00:00, 33.92it/s]100%|██████████| 24/24 [00:00<00:00, 36.58it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
NOT SPARSE AND GPU
TRYING SEACellsGPUDense
Welcome to SEACells GPU!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 29%|██▉       | 7/24 [00:00<00:00, 69.91it/s] 58%|█████▊    | 14/24 [00:00<00:00, 62.87it/s] 88%|████████▊ | 21/24 [00:00<00:00, 64.73it/s]100%|██████████| 24/24 [00:00<00:00, 62.64it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Converged after 36 iterations.
SPARSE AND NOT GPU
TRYING SEACellsCPU
Welcome to SEACells!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 29%|██▉       | 7/24 [00:00<00:00, 65.75it/s] 62%|██████▎   | 15/24 [00:00<00:00, 69.34it/s]100%|██████████| 24/24 [00:00<00:00, 77.36it/s]
Selecting 23 cells from greedy initialization.
Randomly initialized A matrix.
Convergence threshold set to 0.004070181504769342 based on epsilon = 1e-05
Starting iteration 1.
NOT SPARSE AND GPU
TRYING SEACellsGPUDense
Welcome to SEACells GPU!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/50000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/50000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/50000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 643 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/33 [00:00<?, ?it/s]  6%|▌         | 2/33 [00:00<00:03,  8.72it/s]  9%|▉         | 3/33 [00:00<00:04,  7.15it/s] 12%|█▏        | 4/33 [00:00<00:04,  6.95it/s] 15%|█▌        | 5/33 [00:00<00:04,  6.33it/s] 18%|█▊        | 6/33 [00:00<00:04,  6.02it/s] 21%|██        | 7/33 [00:01<00:04,  6.23it/s] 24%|██▍       | 8/33 [00:01<00:04,  5.38it/s] 27%|██▋       | 9/33 [00:01<00:04,  5.26it/s] 30%|███       | 10/33 [00:01<00:04,  4.96it/s] 33%|███▎      | 11/33 [00:01<00:04,  4.92it/s] 36%|███▋      | 12/33 [00:02<00:04,  4.73it/s] 39%|███▉      | 13/33 [00:02<00:04,  4.80it/s] 42%|████▏     | 14/33 [00:02<00:04,  4.51it/s] 45%|████▌     | 15/33 [00:02<00:04,  4.14it/s] 48%|████▊     | 16/33 [00:03<00:04,  4.02it/s] 52%|█████▏    | 17/33 [00:03<00:04,  3.84it/s] 55%|█████▍    | 18/33 [00:03<00:03,  3.78it/s] 58%|█████▊    | 19/33 [00:04<00:03,  3.78it/s] 61%|██████    | 20/33 [00:04<00:03,  3.79it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.63it/s] 67%|██████▋   | 22/33 [00:04<00:03,  3.55it/s] 70%|██████▉   | 23/33 [00:05<00:02,  3.35it/s] 73%|███████▎  | 24/33 [00:05<00:02,  3.17it/s] 76%|███████▌  | 25/33 [00:05<00:02,  3.00it/s] 79%|███████▉  | 26/33 [00:06<00:02,  2.96it/s] 82%|████████▏ | 27/33 [00:06<00:02,  2.83it/s] 85%|████████▍ | 28/33 [00:06<00:01,  2.99it/s] 88%|████████▊ | 29/33 [00:07<00:01,  2.88it/s] 91%|█████████ | 30/33 [00:07<00:01,  2.84it/s] 94%|█████████▍| 31/33 [00:08<00:00,  2.74it/s] 97%|█████████▋| 32/33 [00:08<00:00,  2.81it/s]100%|██████████| 33/33 [00:08<00:00,  2.84it/s]100%|██████████| 33/33 [00:08<00:00,  3.76it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Starting iteration 40.
Completed iteration 40.
Converged after 41 iterations.
Done with 10000 cells, trial 2
SPARSE AND GPU
TRYING SEACellsGPU
Welcome to SEACells GPU!
build_graph.SEACellGraph completed
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s]/home/aparna/miniconda3/lib/python3.9/site-packages/cupyx/scipy/sparse/_compressed.py:545: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive.
  warnings.warn('Changing the sparsity structure of a '
  4%|▍         | 1/24 [00:00<00:05,  4.19it/s]  8%|▊         | 2/24 [00:00<00:05,  4.14it/s] 12%|█▎        | 3/24 [00:00<00:05,  4.06it/s] 17%|█▋        | 4/24 [00:00<00:05,  3.98it/s] 21%|██        | 5/24 [00:01<00:04,  3.94it/s] 25%|██▌       | 6/24 [00:01<00:04,  3.89it/s] 29%|██▉       | 7/24 [00:01<00:04,  3.79it/s] 33%|███▎      | 8/24 [00:02<00:04,  3.74it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.68it/s] 42%|████▏     | 10/24 [00:02<00:03,  3.60it/s] 46%|████▌     | 11/24 [00:02<00:03,  3.54it/s] 50%|█████     | 12/24 [00:03<00:03,  3.49it/s] 54%|█████▍    | 13/24 [00:03<00:03,  3.45it/s] 58%|█████▊    | 14/24 [00:03<00:02,  3.38it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.33it/s] 67%|██████▋   | 16/24 [00:04<00:02,  3.27it/s] 71%|███████   | 17/24 [00:04<00:02,  3.20it/s] 75%|███████▌  | 18/24 [00:05<00:01,  3.16it/s] 79%|███████▉  | 19/24 [00:05<00:01,  3.12it/s] 83%|████████▎ | 20/24 [00:05<00:01,  3.07it/s] 88%|████████▊ | 21/24 [00:06<00:00,  3.02it/s] 92%|█████████▏| 22/24 [00:06<00:00,  2.97it/s] 96%|█████████▌| 23/24 [00:06<00:00,  2.93it/s]100%|██████████| 24/24 [00:07<00:00,  2.89it/s]100%|██████████| 24/24 [00:07<00:00,  3.34it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Convergence threshold set to 0.0017809197686690815 based on epsilon = 1e-05
Starting iteration 1.
NOT SPARSE AND GPU
TRYING SEACellsGPUDense
Welcome to SEACells GPU!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 46%|████▌     | 11/24 [00:00<00:00, 101.45it/s] 96%|█████████▌| 23/24 [00:00<00:00, 110.05it/s]100%|██████████| 24/24 [00:00<00:00, 108.21it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Converged after 36 iterations.
SPARSE AND NOT GPU
TRYING SEACellsCPU
Welcome to SEACells!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 46%|████▌     | 11/24 [00:00<00:00, 99.18it/s] 96%|█████████▌| 23/24 [00:00<00:00, 107.41it/s]100%|██████████| 24/24 [00:00<00:00, 106.33it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Starting iteration 40.
Completed iteration 40.
Converged after 41 iterations.
Done with 10000 cells, trial 3
SPARSE AND GPU
TRYING SEACellsGPU
Welcome to SEACells GPU!
build_graph.SEACellGraph completed
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s]/home/aparna/miniconda3/lib/python3.9/site-packages/cupyx/scipy/sparse/_compressed.py:545: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive.
  warnings.warn('Changing the sparsity structure of a '
  4%|▍         | 1/24 [00:00<00:05,  4.12it/s]  8%|▊         | 2/24 [00:00<00:05,  4.05it/s] 12%|█▎        | 3/24 [00:00<00:05,  4.01it/s] 17%|█▋        | 4/24 [00:01<00:05,  3.97it/s] 21%|██        | 5/24 [00:01<00:04,  3.89it/s] 25%|██▌       | 6/24 [00:01<00:04,  3.85it/s] 29%|██▉       | 7/24 [00:01<00:04,  3.78it/s] 33%|███▎      | 8/24 [00:02<00:04,  3.74it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.69it/s] 42%|████▏     | 10/24 [00:02<00:03,  3.60it/s] 46%|████▌     | 11/24 [00:02<00:03,  3.53it/s] 50%|█████     | 12/24 [00:03<00:03,  3.47it/s] 54%|█████▍    | 13/24 [00:03<00:03,  3.41it/s] 58%|█████▊    | 14/24 [00:03<00:02,  3.37it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.33it/s] 67%|██████▋   | 16/24 [00:04<00:02,  3.27it/s] 71%|███████   | 17/24 [00:04<00:02,  3.21it/s] 75%|███████▌  | 18/24 [00:05<00:01,  3.17it/s] 79%|███████▉  | 19/24 [00:05<00:01,  3.12it/s] 83%|████████▎ | 20/24 [00:05<00:01,  3.07it/s] 88%|████████▊ | 21/24 [00:06<00:00,  3.01it/s] 92%|█████████▏| 22/24 [00:06<00:00,  2.97it/s] 96%|█████████▌| 23/24 [00:06<00:00,  2.92it/s]100%|██████████| 24/24 [00:07<00:00,  2.88it/s]100%|██████████| 24/24 [00:07<00:00,  3.33it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Convergence threshold set to 0.0017809197686690815 based on epsilon = 1e-05
Starting iteration 1.
NOT SPARSE AND GPU
TRYING SEACellsGPUDense
Welcome to SEACells GPU!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 46%|████▌     | 11/24 [00:00<00:00, 102.50it/s]100%|██████████| 24/24 [00:00<00:00, 115.92it/s]100%|██████████| 24/24 [00:00<00:00, 113.58it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Converged after 36 iterations.
SPARSE AND NOT GPU
TRYING SEACellsCPU
Welcome to SEACells!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 50%|█████     | 12/24 [00:00<00:00, 109.80it/s]100%|██████████| 24/24 [00:00<00:00, 115.36it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Starting iteration 40.
Completed iteration 40.
Converged after 41 iterations.
Done with 10000 cells, trial 4
SPARSE AND GPU
TRYING SEACellsGPU
Welcome to SEACells GPU!
build_graph.SEACellGraph completed
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s]/home/aparna/miniconda3/lib/python3.9/site-packages/cupyx/scipy/sparse/_compressed.py:545: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive.
  warnings.warn('Changing the sparsity structure of a '
 12%|█▎        | 3/24 [00:00<00:00, 25.41it/s] 33%|███▎      | 8/24 [00:00<00:00, 35.44it/s] 54%|█████▍    | 13/24 [00:00<00:00, 37.82it/s] 71%|███████   | 17/24 [00:00<00:00, 38.16it/s] 88%|████████▊ | 21/24 [00:00<00:00, 34.35it/s]100%|██████████| 24/24 [00:00<00:00, 34.33it/s]
Selecting 23 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00407
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
SPARSE AND NOT GPU
TRYING SEACellsCPU
Welcome to SEACells!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/50000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/50000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/50000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 643 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.90it/s]  6%|▌         | 2/33 [00:00<00:03,  7.78it/s]  9%|▉         | 3/33 [00:00<00:04,  6.49it/s] 12%|█▏        | 4/33 [00:00<00:04,  6.21it/s] 15%|█▌        | 5/33 [00:00<00:04,  6.46it/s] 18%|█▊        | 6/33 [00:00<00:04,  6.10it/s] 21%|██        | 7/33 [00:01<00:04,  5.39it/s] 24%|██▍       | 8/33 [00:01<00:05,  4.92it/s] 27%|██▋       | 9/33 [00:01<00:04,  5.01it/s] 30%|███       | 10/33 [00:01<00:04,  5.30it/s] 33%|███▎      | 11/33 [00:01<00:04,  4.89it/s] 36%|███▋      | 12/33 [00:02<00:04,  4.91it/s] 39%|███▉      | 13/33 [00:02<00:04,  4.90it/s] 42%|████▏     | 14/33 [00:02<00:04,  4.52it/s] 45%|████▌     | 15/33 [00:02<00:04,  4.43it/s] 48%|████▊     | 16/33 [00:03<00:04,  4.24it/s] 52%|█████▏    | 17/33 [00:03<00:03,  4.28it/s] 55%|█████▍    | 18/33 [00:03<00:03,  4.41it/s] 58%|█████▊    | 19/33 [00:03<00:03,  4.14it/s] 61%|██████    | 20/33 [00:04<00:03,  4.02it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.76it/s] 67%|██████▋   | 22/33 [00:04<00:02,  3.78it/s] 70%|██████▉   | 23/33 [00:05<00:02,  3.60it/s] 73%|███████▎  | 24/33 [00:05<00:02,  3.51it/s] 76%|███████▌  | 25/33 [00:05<00:02,  3.54it/s] 79%|███████▉  | 26/33 [00:05<00:02,  3.37it/s] 82%|████████▏ | 27/33 [00:06<00:01,  3.32it/s] 85%|████████▍ | 28/33 [00:06<00:01,  3.24it/s] 88%|████████▊ | 29/33 [00:06<00:01,  3.24it/s] 91%|█████████ | 30/33 [00:07<00:00,  3.34it/s] 94%|█████████▍| 31/33 [00:07<00:00,  3.18it/s] 97%|█████████▋| 32/33 [00:07<00:00,  2.97it/s]100%|██████████| 33/33 [00:08<00:00,  3.04it/s]100%|██████████| 33/33 [00:08<00:00,  4.02it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Convergence threshold set to 0.0017809197686690815 based on epsilon = 1e-05
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Starting iteration 40.
Completed iteration 40.
Converged after 45 iterations.
NOT SPARSE AND GPU
TRYING SEACellsGPUDense
Welcome to SEACells GPU!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 42%|████▏     | 10/24 [00:00<00:00, 96.48it/s] 96%|█████████▌| 23/24 [00:00<00:00, 111.93it/s]100%|██████████| 24/24 [00:00<00:00, 109.28it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Converged after 36 iterations.
SPARSE AND NOT GPU
TRYING SEACellsCPU
Welcome to SEACells!
Computing kNN graph using scanpy NN ...
Computing radius for adaptive bandwidth kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Making graph symmetric...
Parameter graph_construction = union being used to build KNN graph...
Computing RBF kernel...
  0%|          | 0/10000 [00:00<?, ?it/s]
Building similarity LIL matrix...
  0%|          | 0/10000 [00:00<?, ?it/s]
Constructing CSR matrix...
Building kernel on X_pca
Computing diffusion components from X_pca for waypoint initialization ... 
Determing nearest neighbor graph...
Done.
Sampling waypoints ...
Done.
Selecting 119 cells from waypoint initialization.
Initializing residual matrix using greedy column selection
Initializing f and g...
  0%|          | 0/24 [00:00<?, ?it/s] 42%|████▏     | 10/24 [00:00<00:00, 95.39it/s] 92%|█████████▏| 22/24 [00:00<00:00, 106.32it/s]100%|██████████| 24/24 [00:00<00:00, 105.95it/s]
Selecting 14 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00178
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Starting iteration 40.
Completed iteration 40.
Converged after 41 iterations.
Done with 10000 cells, trial 5
Selecting 23 cells from greedy initialization.
Randomly initialized A matrix.
Setting convergence threshold at 0.00407
Starting iteration 1.
Completed iteration 1.
Starting iteration 10.
Completed iteration 10.
Starting iteration 20.
Completed iteration 20.
Starting iteration 30.
Completed iteration 30.
Converged after 36 iterations.
Traceback (most recent call last):
  File "/data/aparna/aparnakumar/github clone/SEACells/create_results.py", line 165, in <module>
    get_results(num_cells)
  File "/data/aparna/aparnakumar/github clone/SEACells/create_results.py", line 155, in get_results
    assignments[i].to_csv(f"results/{num_cell}_cells/assignments_v4_{trial}.csv")
AttributeError: 'list' object has no attribute 'to_csv'
